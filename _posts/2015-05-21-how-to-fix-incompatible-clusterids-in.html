---
layout: post
title: How to fix Incompatible clusterIDS in Hadoop?
date: '2015-05-21T14:23:00.000+03:00'
author: Dedunu Dhananjaya
tags:
- hadoop
modified_time: '2019-07-09T18:16:07.591+03:00'
blogger_id: tag:blogger.com,1999:blog-8327060682734922468.post-3021865014015427132
permalink: /2015/05/how-to-fix-incompatible-clusterids-in.html
---

<div dir="ltr" style="text-align: left;" trbidi="on"><div style="text-align: justify;">When you are installing and trying to set up your Hadoop cluster you might face an issue like below.</div><pre>FATAL org.apache.hadoop.hdfs.server.datanode.DataNode: Initialization failed for Block pool (Datanode Uuid unassigned) service to master/192.168.1.1:9000. Exiting. <br />java.io.IOException: Incompatible clusterIDs in /home/hadoop/hadoop/data: namenode clusterID = CID-68a4c0d2-5524-486e-8bc9-e1fc3c5c2e29; datanode clusterID = CID-c6c3e9e5-be1c-4a3f-a4b2-bb9441a989c5<br /></pre><div style="text-align: justify;">I just quoted the first two lines of the error. But full stack trace would look like below.</div><script src="https://gist.github.com/dedunumax/e1d2829e0a7f3145d6bc.js"></script> <br /><div style="text-align: justify;">You might haven't formatted your name node properly. But if this was in a test environment you can easily delete data and name node folders, and reformat the HDFS. To format you can run below command.<br /><br /><span style="color: red;">WARNING!!! : IF YOU RUN BELOW COMMAND YOU WILL lose ALL YOUR DATA.</span></div><pre>hdfs namenode -format<br /></pre><div style="text-align: justify;">But if you have a lot of data in your Hadoop cluster and you can't easily format it. Then this post is for you.<br /><br />First, stop all Hadoop processes running. Then login into your name node. Find the value of <b>dfs.namenode.name.dir</b> property. Run below command with your name node folder.</div><pre>cat &lt;dfs.namenode.name.dir&gt;/current/VERSION<br /></pre><div style="text-align: justify;">Then You will see content like below.</div><pre>#Thu May 21 08:29:01 UTC 2015<br />namespaceID=1938842004<br />clusterID=CID-68a4c0d2-5524-486e-8bc9-e1fc3c5c2e29<br />cTime=0<br />storageType=NAME_NODE<br />blockpoolID=BP-2104944316-127.0.1.1-1430820636449<br />layoutVersion=-60<br /></pre><div style="text-align: justify;">Copy the clusterID from name node. Then login into the problematic slave node. Find <b>dfs.datanode.data.dir</b> folder. Run below command to edit the VERSION file.</div><pre>vim &lt;dfs.datanode.data.dir&gt;/current/VERSION <br /></pre><div style="text-align: justify;">Your data node cluster VERSION file will look like below. Replace the cluster ID you copied from name node.</div><pre>#Thu May 21 08:31:31 UTC 2015<br />storageID=DS-b7d3c421-0366-4a66-8d14-78362389ed73<br />clusterID=CID-c6c3e9e5-be1c-4a3f-a4b2-bb9441a989c5<br />cTime=0<br />datanodeUuid=724f8bad-c0ca-4ded-98d6-a860d3165289<br />storageType=DATA_NODE<br />layoutVersion=-56<br /></pre>Then everything will be okay! </div>