---
layout: post
title: Delete using another Table
date: '2012-09-24T16:53:00.000+03:00'
author: Dedunu Dhananjaya
tags:
- SQL
- DELETE
- English
- T-SQL
- TSQL
- SQL Server
modified_time: '2019-07-09T17:09:51.730+03:00'
blogger_id: tag:blogger.com,1999:blog-8327060682734922468.post-9017206561019946734
permalink: /2012/09/delete-using-another-table.html
---

<div dir="ltr" style="text-align: left;" trbidi="on"><div align="justify">In this example, I create a temp table on AdventureWorks2012 Database, and first I load all the data in HumanResources.Employee to the temp table. Then I delete data using HumanResources.Employee. This command will delete all the records in Tmp which has Gender = ‘M’ in HumanResources.Employee table.</div><div align="justify"><pre class="code"><span style="color: blue;">USE </span><span style="color: teal;">[AdventureWorks2012]</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Inserting data from HumanResources.Employee and Person.Person to non existing table</span><span style="color: blue;">SELECT  </span><span style="color: grey;">*<br />    </span><span style="color: blue;">INTO </span><span style="color: teal;">Tmp<br />    </span><span style="color: blue;">FROM </span><span style="color: teal;">[HumanResources]</span><span style="color: grey;">.</span><span style="color: teal;">[Employee] </span><span style="color: blue;">GO<br /></span><span style="color: green;">--DELETE Using another table</span><span style="color: blue;">DELETE </span><span style="color: teal;">Tmp <br />    </span><span style="color: blue;">FROM </span><span style="color: teal;">[HumanResources]</span><span style="color: grey;">.</span><span style="color: teal;">[Employee] </span><span style="color: blue;">AS </span><span style="color: teal;">HE</span><span style="color: grey;">, </span><span style="color: teal;">Tmp<br />    </span><span style="color: blue;">WHERE </span><span style="color: teal;">Tmp</span><span style="color: grey;">.</span><span style="color: teal;">BusinessEntityID </span><span style="color: grey;">= </span><span style="color: teal;">HE</span><span style="color: grey;">.</span><span style="color: teal;">BusinessEntityID<br />    </span><span style="color: grey;">AND </span><span style="color: teal;">HE</span><span style="color: grey;">.</span><span style="color: teal;">Gender </span><span style="color: grey;">= </span><span style="color: red;">'M'<br /></span><span style="color: green;">--Retrieving data</span><span style="color: blue;">SELECT </span><span style="color: grey;">* </span><span style="color: blue;">FROM </span><span style="color: teal;">Tmp</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Dropping Table</span><span style="color: blue;">DROP TABLE </span><span style="color: teal;">Tmp</span><span style="color: blue;">GO</span></pre></div><br /><div align="justify">You can use an inner or outer join to combine those data. </div><br /><div align="justify"><pre class="code"><span style="color: blue;">USE </span><span style="color: teal;">[AdventureWorks2012]</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Inserting data from HumanResources.Employee and Person.Person to non existing table</span><span style="color: blue;">SELECT  </span><span style="color: grey;">*<br />    </span><span style="color: blue;">INTO </span><span style="color: teal;">Tmp<br />    </span><span style="color: blue;">FROM </span><span style="color: teal;">[HumanResources]</span><span style="color: grey;">.</span><span style="color: teal;">[Employee] </span><span style="color: blue;">GO<br /></span><span style="color: green;">--DELETE Using another table</span><span style="color: blue;">DELETE </span><span style="color: teal;">Tmp <br />    </span><span style="color: blue;">FROM </span><span style="color: teal;">[HumanResources]</span><span style="color: grey;">.</span><span style="color: teal;">[Employee] </span><span style="color: blue;">AS </span><span style="color: teal;">HE<br />    </span><span style="color: grey;">INNER JOIN </span><span style="color: teal;">Tmp<br />    </span><span style="color: blue;">ON </span><span style="color: teal;">Tmp</span><span style="color: grey;">.</span><span style="color: teal;">BusinessEntityID </span><span style="color: grey;">= </span><span style="color: teal;">HE</span><span style="color: grey;">.</span><span style="color: teal;">BusinessEntityID<br />    </span><span style="color: blue;">WHERE </span><span style="color: teal;">HE</span><span style="color: grey;">.</span><span style="color: teal;">Gender </span><span style="color: grey;">= </span><span style="color: red;">'M'<br /></span><span style="color: green;">--Retrieving data</span><span style="color: blue;">SELECT </span><span style="color: grey;">* </span><span style="color: blue;">FROM </span><span style="color: teal;">Tmp</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Dropping Table</span><span style="color: blue;">DROP TABLE </span><span style="color: teal;">Tmp</span><span style="color: blue;">GO</span></pre></div><br /><div align="justify">Both of those statements give the same results. It will delete all the male employees.</div></div>