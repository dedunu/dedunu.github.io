---
layout: post
title: Updating from other Tables
date: '2012-09-24T15:48:00.000+03:00'
author: Dedunu Dhananjaya
tags:
- SQL
- English
- T-SQL
- TSQL
- SQL Server
modified_time: '2019-07-09T17:08:32.485+03:00'
blogger_id: tag:blogger.com,1999:blog-8327060682734922468.post-7490666834481873283
permalink: /2012/09/updating-from-other-tables.html
---

<div dir="ltr" style="text-align: left;" trbidi="on"><div align="justify">If you want to synchronize data from another table only for once, you can use this way. When you are going to update from another table don’t forget to give a condition. </div><div align="justify"><pre class="code"><span style="color: blue;">USE </span><span style="color: teal;">[AdventureWorks2012]</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Inserting data from HumanResources.Employee and Person.Person to non existing table</span><span style="color: blue;">SELECT  </span><span style="color: grey;">*<br />    </span><span style="color: blue;">INTO </span><span style="color: teal;">Tmp<br />    </span><span style="color: blue;">FROM </span><span style="color: teal;">[HumanResources]</span><span style="color: grey;">.</span><span style="color: teal;">[Employee] </span><span style="color: blue;">GO<br /></span><span style="color: green;">--Retrieving data</span><span style="color: blue;">SELECT </span><span style="color: grey;">* </span><span style="color: blue;">FROM </span><span style="color: teal;">Tmp<br /></span><span style="color: green;">--Update Using another table</span><span style="color: magenta;">UPDATE </span><span style="color: teal;">Tmp<br />    </span><span style="color: blue;">SET </span><span style="color: teal;">Tmp</span><span style="color: grey;">.</span><span style="color: teal;">JobTitle </span><span style="color: grey;">= </span><span style="color: teal;">HE</span><span style="color: grey;">.</span><span style="color: teal;">JobTitle </span><span style="color: grey;">+ </span><span style="color: red;">', updated'<br />    </span><span style="color: blue;">FROM </span><span style="color: teal;">[HumanResources]</span><span style="color: grey;">.</span><span style="color: teal;">[Employee] </span><span style="color: blue;">AS </span><span style="color: teal;">HE<br />    </span><span style="color: blue;">WHERE </span><span style="color: teal;">Tmp</span><span style="color: grey;">.</span><span style="color: teal;">BusinessEntityID </span><span style="color: grey;">= </span><span style="color: teal;">HE</span><span style="color: grey;">.</span><span style="color: teal;">BusinessEntityID<br /><br /></span><span style="color: green;">--Retrieving data</span><span style="color: blue;">SELECT </span><span style="color: grey;">* </span><span style="color: blue;">FROM </span><span style="color: teal;">Tmp</span><span style="color: blue;">SELECT </span><span style="color: grey;">* </span><span style="color: blue;">FROM </span><span style="color: teal;">HumanResources</span><span style="color: grey;">.</span><span style="color: teal;">Employee</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Dropping Table</span><span style="color: blue;">DROP TABLE </span><span style="color: teal;">Tmp</span><span style="color: blue;">GO</span></pre></div><br /><div align="justify">If you don’t specify a condition for update it will update all the rows with one value. For example, if you run below code you will see the difference.</div><pre class="code"><span style="color: blue;">USE </span><span style="color: teal;">[AdventureWorks2012]</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Inserting data from HumanResources.Employee and Person.Person to non existing table</span><span style="color: blue;">SELECT  </span><span style="color: grey;">*<br />    </span><span style="color: blue;">INTO </span><span style="color: teal;">Tmp<br />    </span><span style="color: blue;">FROM </span><span style="color: teal;">[HumanResources]</span><span style="color: grey;">.</span><span style="color: teal;">[Employee] </span><span style="color: blue;">GO<br /></span><span style="color: green;">--Retrieving data</span><span style="color: blue;">SELECT </span><span style="color: grey;">* </span><span style="color: blue;">FROM </span><span style="color: teal;">Tmp<br /></span><span style="color: green;">--Update Using another table</span><span style="color: magenta;">UPDATE </span><span style="color: teal;">Tmp<br />    </span><span style="color: blue;">SET </span><span style="color: teal;">Tmp</span><span style="color: grey;">.</span><span style="color: teal;">JobTitle </span><span style="color: grey;">= </span><span style="color: teal;">HE</span><span style="color: grey;">.</span><span style="color: teal;">JobTitle </span><span style="color: grey;">+ </span><span style="color: red;">', updated'<br />    </span><span style="color: blue;">FROM </span><span style="color: teal;">[HumanResources]</span><span style="color: grey;">.</span><span style="color: teal;">[Employee] </span><span style="color: blue;">AS </span><span style="color: teal;">HE<br />    </span><span style="color: green;">--WHERE Tmp.BusinessEntityID = HE.BusinessEntityID<br /><br /><br />--Retrieving data</span><span style="color: blue;">SELECT </span><span style="color: grey;">* </span><span style="color: blue;">FROM </span><span style="color: teal;">Tmp</span><span style="color: blue;">SELECT </span><span style="color: grey;">* </span><span style="color: blue;">FROM </span><span style="color: teal;">HumanResources</span><span style="color: grey;">.</span><span style="color: teal;">Employee</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Dropping Table</span><span style="color: blue;">DROP TABLE </span><span style="color: teal;">Tmp</span><span style="color: blue;">GO</span></pre><br />Also, you can use complex update statement using conditions.<br /><pre class="code"><span style="color: blue;">USE </span><span style="color: teal;">[AdventureWorks2012]</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Inserting data from HumanResources.Employee and Person.Person to non existing table</span><span style="color: blue;">SELECT  </span><span style="color: grey;">*<br />    </span><span style="color: blue;">INTO </span><span style="color: teal;">Tmp<br />    </span><span style="color: blue;">FROM </span><span style="color: teal;">[HumanResources]</span><span style="color: grey;">.</span><span style="color: teal;">[Employee] </span><span style="color: blue;">GO<br /></span><span style="color: green;">--Retrieving data</span><span style="color: blue;">SELECT </span><span style="color: grey;">* </span><span style="color: blue;">FROM </span><span style="color: teal;">Tmp<br /></span><span style="color: green;">--Update Using another table</span><span style="color: magenta;">UPDATE </span><span style="color: teal;">Tmp <br />    </span><span style="color: blue;">SET </span><span style="color: teal;">Tmp</span><span style="color: grey;">.</span><span style="color: teal;">JobTitle </span><span style="color: grey;">= </span><span style="color: teal;">HE</span><span style="color: grey;">.</span><span style="color: teal;">JobTitle </span><span style="color: grey;">+ </span><span style="color: red;">', updated'<br />    </span><span style="color: blue;">FROM </span><span style="color: teal;">[HumanResources]</span><span style="color: grey;">.</span><span style="color: teal;">[Employee] </span><span style="color: blue;">AS </span><span style="color: teal;">HE</span><span style="color: grey;">, </span><span style="color: teal;">Tmp </span><span style="color: blue;">AS </span><span style="color: teal;">T<br />    </span><span style="color: blue;">WHERE </span><span style="color: teal;">T</span><span style="color: grey;">.</span><span style="color: teal;">BusinessEntityID </span><span style="color: grey;">= </span><span style="color: teal;">HE</span><span style="color: grey;">.</span><span style="color: teal;">BusinessEntityID<br />    </span><span style="color: grey;">AND </span><span style="color: teal;">HE</span><span style="color: grey;">.</span><span style="color: teal;">Gender </span><span style="color: grey;">= </span><span style="color: red;">'M'<br /><br /></span><span style="color: green;">--Retrieving data</span><span style="color: blue;">SELECT </span><span style="color: grey;">* </span><span style="color: blue;">FROM </span><span style="color: teal;">Tmp</span><span style="color: blue;">SELECT </span><span style="color: grey;">* </span><span style="color: blue;">FROM </span><span style="color: teal;">HumanResources</span><span style="color: grey;">.</span><span style="color: teal;">Employee</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Dropping Table</span><span style="color: blue;">DROP TABLE </span><span style="color: teal;">Tmp</span><span style="color: blue;">GO</span></pre></div>