---
layout: post
title: SELECT INTO
date: '2012-09-24T14:27:00.000+03:00'
author: Dedunu Dhananjaya
tags:
- SQL
- English
- T-SQL
- SELECT
- SQL Server
- INTO
- SELECT INTO
modified_time: '2019-07-09T17:07:42.109+03:00'
blogger_id: tag:blogger.com,1999:blog-8327060682734922468.post-4840222714050137582
permalink: www.dedunu.info/2012/09/select-into.html
---

<div dir="ltr" style="text-align: left;" trbidi="on"><div align="justify">My previous blog post was about <a href="https://dedunumax.wordpress.com/2012/09/24/722/" target="_blank">using the insert in many ways</a>. You can use SELECT INTO to add data from an existing table to a new table. In this statement, SQL Server will create a table for you. You just want to write the query and add INTO clause to the statement. Rest will be done by SQL Server for you.</div><div align="justify"><pre class="code"><span style="color: blue;">USE </span><span style="color: teal;">[AdventureWorks2012]</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Inserting data from HumanResources.Employee to non existing table</span><span style="color: blue;">SELECT  </span><span style="color: teal;">[BusinessEntityID]</span><span style="color: grey;">,<br />        </span><span style="color: teal;">[LoginID]</span><span style="color: grey;">,<br />        </span><span style="color: teal;">[OrganizationNode]</span><span style="color: grey;">,<br />        </span><span style="color: teal;">[JobTitle]</span><span style="color: grey;">,<br />        </span><span style="color: teal;">[BirthDate]</span><span style="color: grey;">,<br />        </span><span style="color: teal;">[MaritalStatus]</span><span style="color: grey;">,<br />        </span><span style="color: teal;">[Gender] <br />    </span><span style="color: blue;">INTO </span><span style="color: teal;">Tmp<br />    </span><span style="color: blue;">FROM </span><span style="color: teal;">HumanResources</span><span style="color: grey;">.</span><span style="color: teal;">Employee</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Retrieving data</span><span style="color: blue;">SELECT </span><span style="color: grey;">* </span><span style="color: blue;">FROM </span><span style="color: teal;">Tmp</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Dropping Table</span><span style="color: blue;">DROP TABLE </span><span style="color: teal;">Tmp</span><span style="color: blue;">GO</span></pre></div><br /><div align="justify">If you are trying to add data into an existing table by using this INTO clause, you will have an error. You can join two tables and add data into the new table too.</div><pre class="code"><span style="color: blue;">USE </span><span style="color: teal;">[AdventureWorks2012]</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Inserting data from HumanResources.Employee and Person.Person to non existing table</span><span style="color: blue;">SELECT  </span><span style="color: teal;">HE</span><span style="color: grey;">.</span><span style="color: teal;">[BusinessEntityID]</span><span style="color: grey;">,<br />        </span><span style="color: teal;">HE</span><span style="color: grey;">.</span><span style="color: teal;">[LoginID]</span><span style="color: grey;">,<br />        </span><span style="color: teal;">HE</span><span style="color: grey;">.</span><span style="color: teal;">[Gender]</span><span style="color: grey;">,</span><span style="color: grey;"><br />        </span><span style="color: teal;">PP</span><span style="color: grey;">.</span><span style="color: teal;">[FirstName]</span><span style="color: grey;">,<br />        </span><span style="color: teal;">PP</span><span style="color: grey;">.</span><span style="color: teal;">[NameStyle]<br />    </span><span style="color: blue;">INTO </span><span style="color: teal;">Tmp<br />    </span><span style="color: blue;">FROM </span><span style="color: teal;">[HumanResources]</span><span style="color: grey;">.</span><span style="color: teal;">[Employee] </span><span style="color: blue;">AS </span><span style="color: teal;">HE<br />    </span><span style="color: grey;">INNER JOIN </span><span style="color: teal;">Person</span><span style="color: grey;">.</span><span style="color: teal;">Person </span><span style="color: blue;">AS </span><span style="color: teal;">PP<br />    </span><span style="color: blue;">ON </span><span style="color: teal;">HE</span><span style="color: grey;">.</span><span style="color: teal;">[BusinessEntityID] </span><span style="color: grey;">= </span><span style="color: teal;">PP</span><span style="color: grey;">.</span><span style="color: teal;">[BusinessEntityID]</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Retrieving data</span><span style="color: blue;">SELECT </span><span style="color: grey;">* </span><span style="color: blue;">FROM </span><span style="color: teal;">Tmp</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Dropping Table</span><span style="color: blue;">DROP TABLE </span><span style="color: teal;">Tmp</span><span style="color: blue;">GO</span></pre><br />And you can use conditions as well.<br /><pre class="code"><span style="color: blue;">USE </span><span style="color: teal;">[AdventureWorks2012]</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Inserting data from HumanResources.Employee and Person.Person to non existing table</span><span style="color: blue;">SELECT  </span><span style="color: teal;">HE</span><span style="color: grey;">.</span><span style="color: teal;">[BusinessEntityID]</span><span style="color: grey;">,<br />        </span><span style="color: teal;">HE</span><span style="color: grey;">.</span><span style="color: teal;">[LoginID]</span><span style="color: grey;">,<br />        </span><span style="color: teal;">HE</span><span style="color: grey;">.</span><span style="color: teal;">[Gender]</span><span style="color: grey;">,</span><span style="color: grey;"><br />        </span><span style="color: teal;">PP</span><span style="color: grey;">.</span><span style="color: teal;">[FirstName]</span><span style="color: grey;">,<br />        </span><span style="color: teal;">PP</span><span style="color: grey;">.</span><span style="color: teal;">[NameStyle]<br />    </span><span style="color: blue;">INTO </span><span style="color: teal;">Tmp<br />    </span><span style="color: blue;">FROM </span><span style="color: teal;">[HumanResources]</span><span style="color: grey;">.</span><span style="color: teal;">[Employee] </span><span style="color: blue;">AS </span><span style="color: teal;">HE<br />    </span><span style="color: grey;">INNER JOIN </span><span style="color: teal;">Person</span><span style="color: grey;">.</span><span style="color: teal;">Person </span><span style="color: blue;">AS </span><span style="color: teal;">PP<br />    </span><span style="color: blue;">ON </span><span style="color: teal;">HE</span><span style="color: grey;">.</span><span style="color: teal;">[BusinessEntityID] </span><span style="color: grey;">= </span><span style="color: teal;">PP</span><span style="color: grey;">.</span><span style="color: teal;">[BusinessEntityID]<br />    </span><span style="color: blue;">WHERE </span><span style="color: teal;">HE</span><span style="color: grey;">.</span><span style="color: teal;">[BusinessEntityID] </span><span style="color: grey;">BETWEEN </span>70 <span style="color: grey;">AND </span>80<br /><span style="color: blue;">GO<br /></span><span style="color: green;">--Retrieving data</span><span style="color: blue;">SELECT </span><span style="color: grey;">* </span><span style="color: blue;">FROM </span><span style="color: teal;">Tmp</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Dropping Table</span><span style="color: blue;">DROP TABLE </span><span style="color: teal;">Tmp</span><span style="color: blue;">GO</span></pre><br />When you are joining two tables consider the column names too. If you are using the same name to two or more columns SQL Server will occur error. Below code will generate such an error.<br /><pre class="code"><span style="color: blue;">USE </span><span style="color: teal;">[AdventureWorks2012]</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Inserting data from HumanResources.Employee and Person.Person to non existing table</span><span style="color: blue;">SELECT  </span><span style="color: teal;">HE</span><span style="color: grey;">.</span><span style="color: teal;">[BusinessEntityID]</span><span style="color: grey;">,<br />        </span><span style="color: teal;">HE</span><span style="color: grey;">.</span><span style="color: teal;">[LoginID]</span><span style="color: grey;">,<br />        </span><span style="color: teal;">HE</span><span style="color: grey;">.</span><span style="color: teal;">[Gender]</span><span style="color: grey;">,<br />        </span><span style="color: teal;">PP</span><span style="color: grey;">.</span><span style="color: teal;">[BusinessEntityID]</span><span style="color: grey;">,<br />        </span><span style="color: teal;">PP</span><span style="color: grey;">.</span><span style="color: teal;">[FirstName]</span><span style="color: grey;">,<br />        </span><span style="color: teal;">PP</span><span style="color: grey;">.</span><span style="color: teal;">[NameStyle]<br />    </span><span style="color: blue;">INTO </span><span style="color: teal;">Tmp<br />    </span><span style="color: blue;">FROM </span><span style="color: teal;">[HumanResources]</span><span style="color: grey;">.</span><span style="color: teal;">[Employee] </span><span style="color: blue;">AS </span><span style="color: teal;">HE<br />    </span><span style="color: grey;">INNER JOIN </span><span style="color: teal;">Person</span><span style="color: grey;">.</span><span style="color: teal;">Person </span><span style="color: blue;">AS </span><span style="color: teal;">PP<br />    </span><span style="color: blue;">ON </span><span style="color: teal;">HE</span><span style="color: grey;">.</span><span style="color: teal;">[BusinessEntityID] </span><span style="color: grey;">= </span><span style="color: teal;">PP</span><span style="color: grey;">.</span><span style="color: teal;">[BusinessEntityID]</span><br /><span style="color: blue;">GO<br /></span><span style="color: green;">--Retrieving data</span><span style="color: blue;">SELECT </span><span style="color: grey;">* </span><span style="color: blue;">FROM </span><span style="color: teal;">Tmp</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Dropping Table</span><span style="color: blue;">DROP TABLE </span><span style="color: teal;">Tmp</span><span style="color: blue;">GO</span></pre></div>