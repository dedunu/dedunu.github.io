---
layout: post
title: Ranking in T-SQL
date: '2012-09-25T14:13:00.000+03:00'
author: Dedunu Dhananjaya
tags:
- SQL
- PARTITION
- T-SQL
- OVER
- Dense_Rank
- English
- PARTITION BY
- Row_Number
- TSQL
- SQL Server
- Rank
- NTILE
modified_time: '2019-07-09T17:12:55.326+03:00'
blogger_id: tag:blogger.com,1999:blog-8327060682734922468.post-5100051602997042809
permalink: www.dedunu.info/2012/09/ranking-in-t-sql.html
---

<div dir="ltr" style="text-align: left;" trbidi="on">In Queries, we need to rank and number records. SQL Server gives you a few functions to rank your records.<br /><strong>RANK</strong><br />Rank we can use to rank data in a normal way. In this ranking, if we have two 1 next to one will have rank 3.&nbsp; <br /><table border="0" cellpadding="2" cellspacing="0" style="width: 401px;"> <tbody><tr> <td valign="top" width="137">Name</td> <td valign="top" width="139">Marks</td> <td valign="top" width="123">Rank</td></tr><tr> <td valign="top" width="137">John</td> <td valign="top" width="152">75</td> <td valign="top" width="156">1</td></tr><tr> <td valign="top" width="137">Mark</td> <td valign="top" width="152">75</td> <td valign="top" width="156">1</td></tr><tr> <td valign="top" width="137">Steve</td> <td valign="top" width="152">64</td> <td valign="top" width="156">3</td></tr><tr> <td valign="top" width="137">Gates</td> <td valign="top" width="152">54</td> <td valign="top" width="156">4</td></tr></tbody></table><br /><pre class="code"><span style="color: blue;">USE </span><span style="color: teal;">[tempdb]</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Creating table Marks</span><span style="color: blue;">CREATE TABLE </span><span style="color: teal;">[MARKS]</span><span style="color: grey;">(<br />    </span><span style="color: teal;">[Name] </span><span style="color: blue;">varchar</span><span style="color: grey;">(</span>25<span style="color: grey;">),<br />    </span><span style="color: teal;">[Score] </span><span style="color: blue;">int</span><span style="color: grey;">)</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Inserting values into Mark table</span><span style="color: blue;">INSERT INTO </span><span style="color: teal;">[MARKS]</span><span style="color: grey;">(</span><span style="color: teal;">[Name]</span><span style="color: grey;">, </span><span style="color: teal;">[Score]</span><span style="color: grey;">) <br />    </span><span style="color: blue;">VALUES </span><span style="color: grey;">(</span><span style="color: red;">'John'</span><span style="color: grey;">,</span>75<span style="color: grey;">),(</span><span style="color: red;">'Mark'</span><span style="color: grey;">,</span>75<span style="color: grey;">),(</span><span style="color: red;">'Steve'</span><span style="color: grey;">,</span>64<span style="color: grey;">),(</span><span style="color: red;">'Gates'</span><span style="color: grey;">,</span>54<span style="color: grey;">)</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Ranking data over Score</span><span style="color: blue;">SELECT </span><span style="color: grey;">*, </span><span style="color: magenta;">RANK</span><span style="color: grey;">() </span><span style="color: blue;">OVER </span><span style="color: grey;">(</span><span style="color: blue;">ORDER BY </span><span style="color: teal;">[Score] </span><span style="color: blue;">DESC</span><span style="color: grey;">) <span style="color: blue;">AS </span><span style="color: teal;">[RANK] </span></span><span style="color: blue;">FROM </span><span style="color: teal;">MARKS<br /></span><span style="color: green;">--Dropping table</span><span style="color: blue;">DROP TABLE </span><span style="color: teal;">[MARKS]</span><span style="color: blue;">GO</span></pre><br />This ranks based on the column that you specify by OVER.<br /><br /><strong>DENSE_RANK</strong><br /><br />Dense Rank is not missing ranks like in normal rank function. It has continuity over ranking.<br /><br /><table border="0" cellpadding="2" cellspacing="0" style="width: 401px;"><tbody><tr><td valign="top" width="137">Name</td><td valign="top" width="139">Marks</td><td valign="top" width="123">Dense Rank</td></tr><tr><td valign="top" width="137">John</td><td valign="top" width="152">75</td><td valign="top" width="156">1</td></tr><tr><td valign="top" width="137">Mark</td><td valign="top" width="152">75</td><td valign="top" width="156">1</td></tr><tr><td valign="top" width="137">Steve</td><td valign="top" width="152">64</td><td valign="top" width="156">2</td></tr><tr><td valign="top" width="137">Gates</td><td valign="top" width="152">54</td><td valign="top" width="156">3</td></tr></tbody></table><br /><br /><pre class="code"><span style="color: blue;">USE </span><span style="color: teal;">[tempdb]</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Creating table Marks</span><span style="color: blue;">CREATE TABLE </span><span style="color: teal;">[MARKS]</span><span style="color: grey;">(<br />    </span><span style="color: teal;">[Name] </span><span style="color: blue;">varchar</span><span style="color: grey;">(</span>25<span style="color: grey;">),<br />    </span><span style="color: teal;">[Score] </span><span style="color: blue;">int</span><span style="color: grey;">)</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Inserting values into Mark table</span><span style="color: blue;">INSERT INTO </span><span style="color: teal;">[MARKS]</span><span style="color: grey;">(</span><span style="color: teal;">[Name]</span><span style="color: grey;">, </span><span style="color: teal;">[Score]</span><span style="color: grey;">) <br />    </span><span style="color: blue;">VALUES </span><span style="color: grey;">(</span><span style="color: red;">'John'</span><span style="color: grey;">,</span>75<span style="color: grey;">),(</span><span style="color: red;">'Mark'</span><span style="color: grey;">,</span>75<span style="color: grey;">),(</span><span style="color: red;">'Steve'</span><span style="color: grey;">,</span>64<span style="color: grey;">),(</span><span style="color: red;">'Gates'</span><span style="color: grey;">,</span>54<span style="color: grey;">)</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Ranking data over Score</span><span style="color: blue;">SELECT </span><span style="color: grey;">*, </span><span style="color: magenta;">DENSE_RANK</span><span style="color: grey;">() </span><span style="color: blue;">OVER </span><span style="color: grey;">(</span><span style="color: blue;">ORDER BY </span><span style="color: teal;">[Score] </span><span style="color: blue;">DESC</span><span style="color: grey;">) </span><span style="color: blue;">AS <span style="color: teal;">[DENSE RANK]</span></span><span style="color: magenta;"> </span><span style="color: blue;">FROM </span><span style="color: teal;">MARKS<br /></span><span style="color: green;">--Dropping table</span><span style="color: blue;">DROP TABLE </span><span style="color: teal;">[MARKS]</span><span style="color: blue;">GO</span></pre><br /><strong>ROW NUMBER</strong><br /><br />Row Number don’t worry much about ranking it just give an incremental number to row. It’s simple.<br /><br /><table border="0" cellpadding="2" cellspacing="0" style="width: 401px;"><tbody><tr><td valign="top" width="137">Name</td><td valign="top" width="139">Marks</td><td valign="top" width="123">Row Number</td></tr><tr><td valign="top" width="137">John</td><td valign="top" width="152">75</td><td valign="top" width="156">1</td></tr><tr><td valign="top" width="137">Mark</td><td valign="top" width="152">75</td><td valign="top" width="156">2</td></tr><tr><td valign="top" width="137">Steve</td><td valign="top" width="152">64</td><td valign="top" width="156">3</td></tr><tr><td valign="top" width="137">Gates</td><td valign="top" width="152">54</td><td valign="top" width="156">4</td></tr></tbody></table><br /><br /><pre class="code"><span style="color: blue;">USE </span><span style="color: teal;">[tempdb]</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Creating table Marks</span><span style="color: blue;">CREATE TABLE </span><span style="color: teal;">[MARKS]</span><span style="color: grey;">(<br />    </span><span style="color: teal;">[Name] </span><span style="color: blue;">varchar</span><span style="color: grey;">(</span>25<span style="color: grey;">),<br />    </span><span style="color: teal;">[Score] </span><span style="color: blue;">int</span><span style="color: grey;">)</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Inserting values into Mark table</span><span style="color: blue;">INSERT INTO </span><span style="color: teal;">[MARKS]</span><span style="color: grey;">(</span><span style="color: teal;">[Name]</span><span style="color: grey;">, </span><span style="color: teal;">[Score]</span><span style="color: grey;">) <br />    </span><span style="color: blue;">VALUES </span><span style="color: grey;">(</span><span style="color: red;">'John'</span><span style="color: grey;">,</span>75<span style="color: grey;">),(</span><span style="color: red;">'Mark'</span><span style="color: grey;">,</span>75<span style="color: grey;">),(</span><span style="color: red;">'Steve'</span><span style="color: grey;">,</span>64<span style="color: grey;">),(</span><span style="color: red;">'Gates'</span><span style="color: grey;">,</span>54<span style="color: grey;">)</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Numbering data over Score</span><span style="color: blue;">SELECT </span><span style="color: grey;">*, </span><span style="color: magenta;">ROW_NUMBER</span><span style="color: grey;">() </span><span style="color: blue;">OVER </span><span style="color: grey;">(</span><span style="color: blue;">ORDER BY </span><span style="color: teal;">[Score] </span><span style="color: blue;">DESC</span><span style="color: grey;">) </span><span style="color: blue;">AS </span><span style="color: teal;">[ROW NUMBER] </span><span style="color: blue;">FROM </span><span style="color: teal;">MARKS<br /></span><span style="color: green;">--Dropping table</span><span style="color: blue;">DROP TABLE </span><span style="color: teal;">[MARKS]</span><span style="color: blue;">GO</span></pre><br /><strong>NTile</strong><br /><br />NTile will separate your code into the number that you parse. If you want to group your results into 3 groups you can use NTILE(3). If you want to divide your results into 7 you can use NTILE(7).<br /><br /><table border="0" cellpadding="2" cellspacing="0" style="width: 401px;"><tbody><tr><td valign="top" width="138">Name</td><td valign="top" width="124">Mark</td><td valign="top" width="137">NTile(3)</td></tr><tr><td valign="top" width="138">Dedunu</td><td valign="top" width="140">89</td><td valign="top" width="167">1</td></tr><tr><td valign="top" width="138">Dhananjaya</td><td valign="top" width="140">85</td><td valign="top" width="167">1</td></tr><tr><td valign="top" width="138">Hasitha</td><td valign="top" width="140">75</td><td valign="top" width="167">2</td></tr><tr><td valign="top" width="138">Shamil</td><td valign="top" width="140">74</td><td valign="top" width="167">2</td></tr><tr><td valign="top" width="138">Sanjana</td><td valign="top" width="140">65</td><td valign="top" width="167">3</td></tr><tr><td valign="top" width="138">Anuradha</td><td valign="top" width="140">55</td><td valign="top" width="167">3</td></tr></tbody></table><br /><br /><pre class="code"><span style="color: blue;">USE </span><span style="color: teal;">[tempdb]</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Creating table Marks</span><span style="color: blue;">CREATE TABLE </span><span style="color: teal;">[MARKS]</span><span style="color: grey;">(<br />    </span><span style="color: teal;">[Name] </span><span style="color: blue;">varchar</span><span style="color: grey;">(</span>25<span style="color: grey;">),<br />    </span><span style="color: teal;">[Score] </span><span style="color: blue;">int</span><span style="color: grey;">)</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Inserting values into Mark table</span><span style="color: blue;">INSERT INTO </span><span style="color: teal;">[MARKS]</span><span style="color: grey;">(</span><span style="color: teal;">[Name]</span><span style="color: grey;">, </span><span style="color: teal;">[Score]</span><span style="color: grey;">) <br />    </span><span style="color: blue;">VALUES </span><span style="color: grey;">(</span><span style="color: red;">'Dedunu'</span><span style="color: grey;">,</span>89<span style="color: grey;">),(</span><span style="color: red;">'Dhananjaya'</span><span style="color: grey;">,</span>85<span style="color: grey;">),(</span><span style="color: red;">'Hasitha'</span><span style="color: grey;">,</span>75<span style="color: grey;">),(</span><span style="color: red;">'Shamil'</span><span style="color: grey;">,</span>74<span style="color: grey;">),(</span><span style="color: red;">'Sanjana'</span><span style="color: grey;">,</span>65<span style="color: grey;">),(</span><span style="color: red;">'Anuradha'</span><span style="color: grey;">,</span>55<span style="color: grey;">)</span><span style="color: blue;">GO<br /></span><span style="color: green;">--NTile(3) over Score</span><span style="color: blue;">SELECT </span><span style="color: grey;">*, </span><span style="color: magenta;">NTILE</span><span style="color: grey;">(</span>3<span style="color: grey;">) </span><span style="color: blue;">OVER </span><span style="color: grey;">(</span><span style="color: blue;">ORDER BY </span><span style="color: teal;">[Score] </span><span style="color: blue;">DESC</span><span style="color: grey;">) </span><span style="color: blue;">AS </span><span style="color: teal;">[NTile(3)] </span><span style="color: blue;">FROM </span><span style="color: teal;">MARKS<br /></span><span style="color: green;">--Dropping table</span><span style="color: blue;">DROP TABLE </span><span style="color: teal;">[MARKS]</span><span style="color: blue;">GO</span></pre><br />If you are going to group them into 4, you will have this result. It always tries to round to the lower numbers.<br /><br /><table border="0" cellpadding="2" cellspacing="0" style="width: 401px;"><tbody><tr><td valign="top" width="138">Name</td><td valign="top" width="124">Mark</td><td valign="top" width="137">NTile(4)</td></tr><tr><td valign="top" width="138">Dedunu</td><td valign="top" width="140">89</td><td valign="top" width="167">1</td></tr><tr><td valign="top" width="138">Dhananjaya</td><td valign="top" width="140">85</td><td valign="top" width="167">1</td></tr><tr><td valign="top" width="138">Hasitha</td><td valign="top" width="140">75</td><td valign="top" width="167">2</td></tr><tr><td valign="top" width="138">Shamil</td><td valign="top" width="140">74</td><td valign="top" width="167">2</td></tr><tr><td valign="top" width="138">Sanjana</td><td valign="top" width="140">65</td><td valign="top" width="167">3</td></tr><tr><td valign="top" width="138">Anuradha</td><td valign="top" width="140">55</td><td valign="top" width="167">4</td></tr></tbody></table><br /><pre class="code"><span style="color: blue;">USE </span><span style="color: teal;">[tempdb]</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Creating table Marks</span><span style="color: blue;">CREATE TABLE </span><span style="color: teal;">[MARKS]</span><span style="color: grey;">(<br />    </span><span style="color: teal;">[Name] </span><span style="color: blue;">varchar</span><span style="color: grey;">(</span>25<span style="color: grey;">),<br />    </span><span style="color: teal;">[Score] </span><span style="color: blue;">int</span><span style="color: grey;">)</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Inserting values into Mark table</span><span style="color: blue;">INSERT INTO </span><span style="color: teal;">[MARKS]</span><span style="color: grey;">(</span><span style="color: teal;">[Name]</span><span style="color: grey;">, </span><span style="color: teal;">[Score]</span><span style="color: grey;">) <br />    </span><span style="color: blue;">VALUES </span><span style="color: grey;">(</span><span style="color: red;">'Dedunu'</span><span style="color: grey;">,</span>89<span style="color: grey;">),(</span><span style="color: red;">'Dhananjaya'</span><span style="color: grey;">,</span>85<span style="color: grey;">),(</span><span style="color: red;">'Hasitha'</span><span style="color: grey;">,</span>75<span style="color: grey;">),(</span><span style="color: red;">'Shamil'</span><span style="color: grey;">,</span>74<span style="color: grey;">),(</span><span style="color: red;">'Sanjana'</span><span style="color: grey;">,</span>65<span style="color: grey;">),(</span><span style="color: red;">'Anuradha'</span><span style="color: grey;">,</span>55<span style="color: grey;">)</span><span style="color: blue;">GO<br /></span><span style="color: green;">--NTile(4) over Score</span><span style="color: blue;">SELECT </span><span style="color: grey;">*, </span><span style="color: magenta;">NTILE</span><span style="color: grey;">(</span>4<span style="color: grey;">) </span><span style="color: blue;">OVER </span><span style="color: grey;">(</span><span style="color: blue;">ORDER BY </span><span style="color: teal;">[Score] </span><span style="color: blue;">DESC</span><span style="color: grey;">) </span><span style="color: blue;">AS </span><span style="color: teal;">[NTile(4)] </span><span style="color: blue;">FROM </span><span style="color: teal;">MARKS<br /></span><span style="color: green;">--Dropping table</span><span style="color: blue;">DROP TABLE </span><span style="color: teal;">[MARKS]</span><span style="color: blue;">GO</span></pre><br />Then if you are going to group odd numbered records by even or even numbered records by odd, first tile will have an extra record.<br /><br /><table border="0" cellpadding="2" cellspacing="0" style="width: 401px;"><tbody><tr><td valign="top" width="138">Name</td><td valign="top" width="124">Mark</td><td valign="top" width="137">NTile(5)</td></tr><tr><td valign="top" width="138">Dedunu</td><td valign="top" width="140">89</td><td valign="top" width="167">1</td></tr><tr><td valign="top" width="138">Dhananjaya</td><td valign="top" width="140">85</td><td valign="top" width="167">1</td></tr><tr><td valign="top" width="138">Hasitha</td><td valign="top" width="140">75</td><td valign="top" width="167">2</td></tr><tr><td valign="top" width="138">Shamil</td><td valign="top" width="140">74</td><td valign="top" width="167">3</td></tr><tr><td valign="top" width="138">Sanjana</td><td valign="top" width="140">65</td><td valign="top" width="167">4</td></tr><tr><td valign="top" width="138">Anuradha</td><td valign="top" width="140">55</td><td valign="top" width="167">5</td></tr></tbody></table><br /><br /><pre class="code"><span style="color: blue;">USE </span><span style="color: teal;">[tempdb]</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Creating table Marks</span><span style="color: blue;">CREATE TABLE </span><span style="color: teal;">[MARKS]</span><span style="color: grey;">(<br />    </span><span style="color: teal;">[Name] </span><span style="color: blue;">varchar</span><span style="color: grey;">(</span>25<span style="color: grey;">),<br />    </span><span style="color: teal;">[Score] </span><span style="color: blue;">int</span><span style="color: grey;">)</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Inserting values into Mark table</span><span style="color: blue;">INSERT INTO </span><span style="color: teal;">[MARKS]</span><span style="color: grey;">(</span><span style="color: teal;">[Name]</span><span style="color: grey;">, </span><span style="color: teal;">[Score]</span><span style="color: grey;">) <br />    </span><span style="color: blue;">VALUES </span><span style="color: grey;">(</span><span style="color: red;">'Dedunu'</span><span style="color: grey;">,</span>89<span style="color: grey;">),(</span><span style="color: red;">'Dhananjaya'</span><span style="color: grey;">,</span>85<span style="color: grey;">),(</span><span style="color: red;">'Hasitha'</span><span style="color: grey;">,</span>75<span style="color: grey;">),(</span><span style="color: red;">'Shamil'</span><span style="color: grey;">,</span>74<span style="color: grey;">),(</span><span style="color: red;">'Sanjana'</span><span style="color: grey;">,</span>65<span style="color: grey;">),(</span><span style="color: red;">'Anuradha'</span><span style="color: grey;">,</span>55<span style="color: grey;">)</span><span style="color: blue;">GO<br /></span><span style="color: green;">--NTile(5) over Score</span><span style="color: blue;">SELECT </span><span style="color: grey;">*, </span><span style="color: magenta;">NTILE</span><span style="color: grey;">(</span>5<span style="color: grey;">) </span><span style="color: blue;">OVER </span><span style="color: grey;">(</span><span style="color: blue;">ORDER BY </span><span style="color: teal;">[Score] </span><span style="color: blue;">DESC</span><span style="color: grey;">) </span><span style="color: blue;">AS </span><span style="color: teal;">[NTile(5)] </span><span style="color: blue;">FROM </span><span style="color: teal;">MARKS<br /></span><span style="color: green;">--Dropping table</span><span style="color: blue;">DROP TABLE </span><span style="color: teal;">[MARKS]</span><span style="color: blue;">GO</span></pre><br />If you are trying to group records by more than records number or same number it will act like ROW_NUMBER function.&nbsp; <br /><br /><br /><table border="0" cellpadding="2" cellspacing="0" style="width: 401px;"><tbody><tr><td valign="top" width="138">Name</td><td valign="top" width="124">Mark</td><td valign="top" width="137">NTile(&gt;=6)</td></tr><tr><td valign="top" width="138">Dedunu</td><td valign="top" width="140">89</td><td valign="top" width="167">1</td></tr><tr><td valign="top" width="138">Dhananjaya</td><td valign="top" width="140">85</td><td valign="top" width="167">2</td></tr><tr><td valign="top" width="138">Hasitha</td><td valign="top" width="140">75</td><td valign="top" width="167">3</td></tr><tr><td valign="top" width="138">Shamil</td><td valign="top" width="140">74</td><td valign="top" width="167">4</td></tr><tr><td valign="top" width="138">Sanjana</td><td valign="top" width="140">65</td><td valign="top" width="167">5</td></tr><tr><td valign="top" width="138">Anuradha</td><td valign="top" width="140">55</td><td valign="top" width="167">6</td></tr></tbody></table><br /><br /><pre class="code"><span style="color: blue;">USE </span><span style="color: teal;">[tempdb]</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Creating table Marks</span><span style="color: blue;">CREATE TABLE </span><span style="color: teal;">[MARKS]</span><span style="color: grey;">(<br />    </span><span style="color: teal;">[Name] </span><span style="color: blue;">varchar</span><span style="color: grey;">(</span>25<span style="color: grey;">),<br />    </span><span style="color: teal;">[Score] </span><span style="color: blue;">int</span><span style="color: grey;">)</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Inserting values into Mark table</span><span style="color: blue;">INSERT INTO </span><span style="color: teal;">[MARKS]</span><span style="color: grey;">(</span><span style="color: teal;">[Name]</span><span style="color: grey;">, </span><span style="color: teal;">[Score]</span><span style="color: grey;">) <br />    </span><span style="color: blue;">VALUES </span><span style="color: grey;">(</span><span style="color: red;">'Dedunu'</span><span style="color: grey;">,</span>89<span style="color: grey;">),(</span><span style="color: red;">'Dhananjaya'</span><span style="color: grey;">,</span>85<span style="color: grey;">),(</span><span style="color: red;">'Hasitha'</span><span style="color: grey;">,</span>75<span style="color: grey;">),(</span><span style="color: red;">'Shamil'</span><span style="color: grey;">,</span>74<span style="color: grey;">),(</span><span style="color: red;">'Sanjana'</span><span style="color: grey;">,</span>65<span style="color: grey;">),(</span><span style="color: red;">'Anuradha'</span><span style="color: grey;">,</span>55<span style="color: grey;">)</span><span style="color: blue;">GO<br /></span><span style="color: green;">--NTile(6) data over Score</span><span style="color: blue;">SELECT </span><span style="color: grey;">*, </span><span style="color: magenta;">NTILE</span><span style="color: grey;">(</span>6<span style="color: grey;">) </span><span style="color: blue;">OVER </span><span style="color: grey;">(</span><span style="color: blue;">ORDER BY </span><span style="color: teal;">[Score] </span><span style="color: blue;">DESC</span><span style="color: grey;">) </span><span style="color: blue;">AS </span><span style="color: teal;">[NTile(6)] </span><span style="color: blue;">FROM </span><span style="color: teal;">MARKS<br /></span><span style="color: green;">--Dropping table</span><span style="color: blue;">DROP TABLE </span><span style="color: teal;">[MARKS]</span><span style="color: blue;">GO</span></pre><br /><br /><pre class="code"><span style="color: blue;">USE </span><span style="color: teal;">[tempdb]</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Creating table Marks</span><span style="color: blue;">CREATE TABLE </span><span style="color: teal;">[MARKS]</span><span style="color: grey;">(<br />    </span><span style="color: teal;">[Name] </span><span style="color: blue;">varchar</span><span style="color: grey;">(</span>25<span style="color: grey;">),<br />    </span><span style="color: teal;">[Score] </span><span style="color: blue;">int</span><span style="color: grey;">)</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Inserting values into Mark table</span><span style="color: blue;">INSERT INTO </span><span style="color: teal;">[MARKS]</span><span style="color: grey;">(</span><span style="color: teal;">[Name]</span><span style="color: grey;">, </span><span style="color: teal;">[Score]</span><span style="color: grey;">) <br />    </span><span style="color: blue;">VALUES </span><span style="color: grey;">(</span><span style="color: red;">'Dedunu'</span><span style="color: grey;">,</span>89<span style="color: grey;">),(</span><span style="color: red;">'Dhananjaya'</span><span style="color: grey;">,</span>85<span style="color: grey;">),(</span><span style="color: red;">'Hasitha'</span><span style="color: grey;">,</span>75<span style="color: grey;">),(</span><span style="color: red;">'Shamil'</span><span style="color: grey;">,</span>74<span style="color: grey;">),(</span><span style="color: red;">'Sanjana'</span><span style="color: grey;">,</span>65<span style="color: grey;">),(</span><span style="color: red;">'Anuradha'</span><span style="color: grey;">,</span>55<span style="color: grey;">)</span><span style="color: blue;">GO<br /></span><span style="color: green;">--NTile(8) over Score</span><span style="color: blue;">SELECT </span><span style="color: grey;">*, </span><span style="color: magenta;">NTILE</span><span style="color: grey;">(</span>8<span style="color: grey;">) </span><span style="color: blue;">OVER </span><span style="color: grey;">(</span><span style="color: blue;">ORDER BY </span><span style="color: teal;">[Score] </span><span style="color: blue;">DESC</span><span style="color: grey;">) </span><span style="color: blue;">AS </span><span style="color: teal;">[NTile(8)] </span><span style="color: blue;">FROM </span><span style="color: teal;">MARKS<br /></span><span style="color: green;">--Dropping table</span><span style="color: blue;">DROP TABLE </span><span style="color: teal;">[MARKS]</span><span style="color: blue;">GO</span></pre><br /><strong>PARTITION BY</strong><br /><br />Let's move to Partition By clause. If you want to categorize your ranks into any other factor, you can use PARTITION BY clause. It lets you have separate rankings on a factor that you want.<br /><br /><table border="0" cellpadding="2" cellspacing="0" style="width: 402px;"><tbody><tr><td valign="top" width="113">Name</td><td valign="top" width="74">Subject</td><td valign="top" width="98">Mark</td><td valign="top" width="115">Rank</td></tr><tr><td valign="top" width="113">Hasitha</td><td valign="top" width="74">Eng</td><td valign="top" width="98">75</td><td valign="top" width="115">1</td></tr><tr><td valign="top" width="113">Anuradha</td><td valign="top" width="74">Eng</td><td valign="top" width="98">55</td><td valign="top" width="115">2</td></tr><tr><td valign="top" width="113">Dedunu</td><td valign="top" width="74">Math</td><td valign="top" width="98">89</td><td valign="top" width="115">1</td></tr><tr><td valign="top" width="113">Dhananjaya</td><td valign="top" width="74">Math</td><td valign="top" width="98">85</td><td valign="top" width="115">2</td></tr><tr><td valign="top" width="113">Sanjana</td><td valign="top" width="74">Math</td><td valign="top" width="98">65</td><td valign="top" width="115">3</td></tr><tr><td valign="top" width="113">Shamil</td><td valign="top" width="79">Sci</td><td valign="top" width="110">74</td><td valign="top" width="138">1</td></tr></tbody></table><br /><pre class="code"><span style="color: blue;">USE </span><span style="color: teal;">[tempdb]</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Creating table Marks</span><span style="color: blue;">CREATE TABLE </span><span style="color: teal;">[MARKS]</span><span style="color: grey;">(<br />    </span><span style="color: teal;">[Name] </span><span style="color: blue;">varchar</span><span style="color: grey;">(</span>25<span style="color: grey;">),<br />    </span><span style="color: teal;">[Subject] </span><span style="color: blue;">varchar</span><span style="color: grey;">(</span>25<span style="color: grey;">),<br />    </span><span style="color: teal;">[Score] </span><span style="color: blue;">int</span><span style="color: grey;">)</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Inserting values into Mark table</span><span style="color: blue;">INSERT INTO </span><span style="color: teal;">[MARKS]</span><span style="color: grey;">(</span><span style="color: teal;">[Name]</span><span style="color: grey;">, </span><span style="color: teal;">[Subject]</span><span style="color: grey;">, </span><span style="color: teal;">[Score]</span><span style="color: grey;">) <br />    </span><span style="color: blue;">VALUES </span><span style="color: grey;">(</span><span style="color: red;">'Dedunu'</span><span style="color: grey;">,</span><span style="color: red;">'Math'</span><span style="color: grey;">,</span>89<span style="color: grey;">),(</span><span style="color: red;">'Dhananjaya'</span><span style="color: grey;">,</span><span style="color: red;">'Math'</span><span style="color: grey;">,</span>85<span style="color: grey;">),(</span><span style="color: red;">'Hasitha'</span><span style="color: grey;">,</span><span style="color: red;">'Eng'</span><span style="color: grey;">,</span>75<span style="color: grey;">),(</span><span style="color: red;">'Shamil'</span><span style="color: grey;">,</span><span style="color: red;">'Sci'</span><span style="color: grey;">,</span>74<span style="color: grey;">),(</span><span style="color: red;">'Sanjana'</span><span style="color: grey;">,</span><span style="color: red;">'Math'</span><span style="color: grey;">,</span>65<span style="color: grey;">),(</span><span style="color: red;">'Anuradha'</span><span style="color: grey;">,</span><span style="color: red;">'Eng'</span><span style="color: grey;">,</span>55<span style="color: grey;">)</span><span style="color: blue;">GO<br /></span><span style="color: green;">--Partitioning rank by Suject, and ranking over Score</span><span style="color: blue;">SELECT </span><span style="color: grey;">*, </span><span style="color: magenta;">RANK</span><span style="color: grey;">() </span><span style="color: blue;">OVER </span><span style="color: grey;">(</span><span style="color: blue;">PARTITION BY </span><span style="color: teal;">[Subject] </span><span style="color: blue;">ORDER BY </span><span style="color: teal;">[Score] </span><span style="color: blue;">DESC</span><span style="color: grey;">) </span><span style="color: blue;">AS </span><span style="color: teal;">[RANK] </span><span style="color: blue;">FROM </span><span style="color: teal;">MARKS<br /></span><span style="color: green;">--Dropping table</span><span style="color: blue;">DROP TABLE </span><span style="color: teal;">[MARKS]</span><span style="color: blue;">GO</span></pre></div>